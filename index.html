<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskFlow - Official Task Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Animations */
        .task-item {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .task-completed {
            animation: strikeThrough 0.3s ease-out forwards;
        }
        @keyframes strikeThrough {
            to {
                text-decoration: line-through;
                opacity: 0.6;
            }
        }
        .fade-out {
            animation: fadeOut 0.3s ease-out forwards;
        }
        @keyframes fadeOut {
            to {
                opacity: 0;
                transform: translateX(20px);
            }
        }
        
        /* Dark mode */
        .dark {
            background-color: #1a202c;
            color: #e2e8f0;
        }
        .dark .bg-white {
            background-color: #2d3748;
        }
        .dark .bg-gray-50 {
            background-color: #1a202c;
        }
        .dark .text-gray-800 {
            color: #e2e8f0;
        }
        .dark .text-gray-500 {
            color: #a0aec0;
        }
        .dark .text-gray-400 {
            color: #718096;
        }
        .dark .border-gray-300 {
            border-color: #4a5568;
        }
        .dark .hover\:bg-gray-50:hover {
            background-color: #2d3748;
        }
        .dark .shadow-sm {
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.3);
        }
        
        /* Priority colors */
        .priority-high { border-left: 4px solid #e53e3e; }
        .priority-medium { border-left: 4px solid #dd6b20; }
        .priority-low { border-left: 4px solid #38a169; }
        
        /* Category badges */
        .category-work { background-color: #ebf8ff; color: #2b6cb0; }
        .category-personal { background-color: #faf5ff; color: #805ad5; }
        .category-health { background-color: #f0fff4; color: #2f855a; }
        .category-other { background-color: #edf2f7; color: #4a5568; }
        
        .dark .category-work { background-color: #2c5282; color: #90cdf4; }
        .dark .category-personal { background-color: #553c9a; color: #d6bcfa; }
        .dark .category-health { background-color: #276749; color: #9ae6b4; }
        .dark .category-other { background-color: #2d3748; color: #cbd5e0; }
        
        /* Progress bar */
        .progress-bar {
            transition: width 0.5s ease-out;
        }
        
        /* Edit mode */
        .edit-input {
            background: transparent;
            border: 1px solid #3182ce;
            border-radius: 4px;
            padding: 2px 8px;
            outline: none;
        }
        
        /* Focus animation */
        @keyframes focusPulse {
            0% {
                box-shadow: 0 0 0 0 rgba(49, 130, 206, 0.4);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(49, 130, 206, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(49, 130, 206, 0);
            }
        }
        .focus-animation {
            animation: focusPulse 1.5s ease-out;
        }
        
        /* Print styles */
        @media print {
            body { background-color: white; color: black; }
            .no-print { display: none !important; }
            .bg-white, .dark .bg-white { background-color: white !important; color: black !important; }
            .text-gray-800, .dark .text-gray-800 { color: black !important; }
            .task-item { break-inside: avoid; }
            .task-completed { text-decoration: line-through; opacity: 0.6; }
            .progress-bar { background-color: #3182ce !important; }
        }
        
        /* Loading animation */
        .loader {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3182ce;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen transition-colors duration-300">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Header -->
        <header class="mb-8">
            <div class="flex justify-between items-center mb-4">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-blue-700 rounded-lg flex items-center justify-center">
                        <i class="fas fa-tasks text-white"></i>
                    </div>
                    <div>
                        <h1 class="text-3xl font-semibold text-gray-800">TaskFlow</h1>
                        <p class="text-sm text-gray-500">Official Task Management System</p>
                    </div>
                </div>
                <div class="flex gap-3">
                    <button id="printBtn" class="no-print px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors duration-200 flex items-center gap-2">
                        <i class="fas fa-print"></i>
                        Print
                    </button>
                    <button id="darkModeToggle" class="no-print px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors duration-200 flex items-center gap-2">
                        <i class="fas fa-moon"></i>
                        Theme
                    </button>
                </div>
            </div>
            <div class="flex justify-between items-center">
                <p class="text-gray-500" id="currentDate"></p>
                <div class="text-sm text-gray-500">
                    <span id="userSession">Session: User</span> | 
                    <span id="lastSaved">Last saved: Just now</span>
                </div>
            </div>
        </header>

        <!-- Progress Bar -->
        <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
            <div class="flex justify-between items-center mb-2">
                <span class="text-sm font-medium text-gray-700">Daily Progress</span>
                <span class="text-sm font-medium text-gray-800" id="progressText">0%</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2.5">
                <div id="progressBar" class="progress-bar bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
            </div>
        </div>

        <!-- Stats -->
        <div class="bg-white rounded-lg shadow-sm p-4 mb-6 grid grid-cols-4 gap-4">
            <div class="text-center p-3 bg-blue-50 rounded-lg">
                <p class="text-2xl font-semibold text-blue-700" id="totalTasks">0</p>
                <p class="text-sm text-blue-600">Total Tasks</p>
            </div>
            <div class="text-center p-3 bg-green-50 rounded-lg">
                <p class="text-2xl font-semibold text-green-700" id="completedTasks">0</p>
                <p class="text-sm text-green-600">Completed</p>
            </div>
            <div class="text-center p-3 bg-yellow-50 rounded-lg">
                <p class="text-2xl font-semibold text-yellow-700" id="pendingTasks">0</p>
                <p class="text-sm text-yellow-600">Pending</p>
            </div>
            <div class="text-center p-3 bg-red-50 rounded-lg">
                <p class="text-2xl font-semibold text-red-700" id="highPriorityTasks">0</p>
                <p class="text-sm text-red-600">High Priority</p>
            </div>
        </div>

        <!-- Filters -->
        <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
            <div class="flex flex-wrap gap-2 mb-3">
                <button class="filter-btn px-3 py-1 text-sm rounded-full bg-blue-600 text-white font-medium" data-filter="all">All Tasks</button>
                <button class="filter-btn px-3 py-1 text-sm rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 font-medium" data-filter="active">Active</button>
                <button class="filter-btn px-3 py-1 text-sm rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 font-medium" data-filter="completed">Completed</button>
                <button class="filter-btn px-3 py-1 text-sm rounded-full bg-gray-200 text-gray-700 hover:bg-gray-300 font-medium" data-filter="high">High Priority</button>
            </div>
            <div class="flex gap-2">
                <div class="relative flex-1">
                    <input 
                        type="text" 
                        id="searchInput" 
                        placeholder="Search tasks..." 
                        class="w-full pl-10 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                    >
                    <i class="fas fa-search absolute left-3 top-2.5 text-gray-400"></i>
                </div>
                <select id="categoryFilter" class="px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="">All Categories</option>
                    <option value="work">Work</option>
                    <option value="personal">Personal</option>
                    <option value="health">Health</option>
                    <option value="other">Other</option>
                </select>
            </div>
        </div>

        <!-- Add Task Form -->
        <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
            <h3 class="text-lg font-medium text-gray-800 mb-3">Create New Task</h3>
            <form id="taskForm">
                <div class="flex gap-2 mb-3">
                    <input 
                        type="text" 
                        id="taskInput" 
                        placeholder="Enter task description..." 
                        class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus-animation"
                        autocomplete="off"
                    >
                    <button 
                        type="submit" 
                        class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 flex items-center gap-2 font-medium"
                    >
                        <i class="fas fa-plus"></i>
                        Add Task
                    </button>
                </div>
                <div class="flex gap-2 flex-wrap">
                    <select id="prioritySelect" class="px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="low">Low Priority</option>
                        <option value="medium" selected>Medium Priority</option>
                        <option value="high">High Priority</option>
                    </select>
                    <select id="categorySelect" class="px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="work">Work</option>
                        <option value="personal">Personal</option>
                        <option value="health">Health</option>
                        <option value="other">Other</option>
                    </select>
                    <input 
                        type="time" 
                        id="timeInput" 
                        class="px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                    >
                    <button type="button" id="clearForm" class="px-3 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors duration-200">
                        <i class="fas fa-eraser"></i> Clear
                    </button>
                </div>
            </form>
        </div>

        <!-- Task List -->
        <div class="bg-white rounded-lg shadow-sm p-4 mb-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-medium text-gray-800">Task Registry</h2>
                <div class="flex gap-2">
                    <button 
                        id="clearCompleted" 
                        class="text-sm text-red-600 hover:text-red-700 transition-colors duration-200 hidden font-medium"
                    >
                        <i class="fas fa-trash-alt mr-1"></i>
                        Clear Completed
                    </button>
                    <button 
                        id="sortTasks" 
                        class="text-sm text-gray-600 hover:text-gray-800 transition-colors duration-200 font-medium"
                    >
                        <i class="fas fa-sort mr-1"></i>
                        Sort
                    </button>
                </div>
            </div>
            <div id="taskList" class="space-y-2">
                <!-- Tasks will be dynamically added here -->
            </div>
            <div id="emptyState" class="text-center py-12 text-gray-400">
                <i class="fas fa-clipboard-list text-5xl mb-4"></i>
                <p class="text-lg">No tasks in registry. Add a task above.</p>
            </div>
        </div>

        <!-- Keyboard Shortcuts Help -->
        <div class="no-print bg-white rounded-lg shadow-sm p-4 mb-6">
            <h3 class="text-md font-medium text-gray-800 mb-2">Keyboard Shortcuts</h3>
            <div class="grid grid-cols-3 gap-2 text-sm">
                <div><kbd class="px-2 py-1 bg-gray-200 rounded">Alt+N</kbd> New task</div>
                <div><kbd class="px-2 py-1 bg-gray-200 rounded">Alt+F</kbd> Search</div>
                <div><kbd class="px-2 py-1 bg-gray-200 rounded">Alt+D</kbd> Dark mode</div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center text-sm text-gray-500 py-4 border-t border-gray-200">
            <p>© 2023 TaskFlow Management System. All rights reserved.</p>
            <p class="mt-1">Version 1.0.0 | Official Release</p>
        </footer>
    </div>

    <script>
        $(document).ready(function() {
            // Initialize
            let tasks = JSON.parse(localStorage.getItem('dailyTasks')) || [];
            let taskIdCounter = tasks.length > 0 ? Math.max(...tasks.map(t => t.id)) + 1 : 1;
            let currentFilter = 'all';
            let currentCategoryFilter = '';
            let sortBy = 'created'; // created, priority, time

            // Dark mode
            const isDarkMode = localStorage.getItem('darkMode') === 'true';
            if (isDarkMode) {
                $('body').addClass('dark');
                $('#darkModeToggle i').removeClass('fa-moon').addClass('fa-sun');
            }

            // Set current date
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            $('#currentDate').text(new Date().toLocaleDateString('en-US', options));

            // Render tasks
            renderTasks();
            updateStats();
            updateProgress();

            // Focus on task input when page loads
            setTimeout(() => {
                $('#taskInput').focus();
            }, 100);

            // Dark mode toggle
            $('#darkModeToggle').on('click', function() {
                $('body').toggleClass('dark');
                const isDark = $('body').hasClass('dark');
                localStorage.setItem('darkMode', isDark);
                $(this).find('i').toggleClass('fa-moon fa-sun');
            });

            // Print button
            $('#printBtn').on('click', function() {
                window.print();
            });

            // Clear form button
            $('#clearForm').on('click', function() {
                $('#taskInput').val('').focus();
                $('#prioritySelect').val('medium');
                $('#categorySelect').val('work');
                $('#timeInput').val('');
            });

            // Add task
            $('#taskForm').on('submit', function(e) {
                e.preventDefault();
                const taskText = $('#taskInput').val().trim();
                
                if (taskText) {
                    // Show loading indicator
                    const submitBtn = $(this).find('button[type="submit"]');
                    const originalText = submitBtn.html();
                    submitBtn.html('<div class="loader"></div> Adding...');
                    submitBtn.prop('disabled', true);
                    
                    setTimeout(() => {
                        const newTask = {
                            id: taskIdCounter++,
                            text: taskText,
                            completed: false,
                            priority: $('#prioritySelect').val(),
                            category: $('#categorySelect').val(),
                            time: $('#timeInput').val(),
                            createdAt: new Date().toISOString()
                        };
                        
                        tasks.unshift(newTask);
                        saveTasks();
                        renderTasks();
                        updateStats();
                        updateProgress();
                        
                        // Reset form and focus back to input
                        $('#taskInput').val('').focus();
                        $('#prioritySelect').val('medium');
                        $('#categorySelect').val('work');
                        $('#timeInput').val('');
                        
                        // Restore button
                        submitBtn.html(originalText);
                        submitBtn.prop('disabled', false);
                        
                        // Update last saved time
                        updateLastSaved();
                    }, 500);
                }
            });

            // Toggle task completion
            $(document).on('change', '.task-checkbox', function() {
                const taskId = parseInt($(this).data('id'));
                const task = tasks.find(t => t.id === taskId);
                
                if (task) {
                    task.completed = $(this).is(':checked');
                    saveTasks();
                    
                    const taskText = $(this).siblings('.task-text');
                    if (task.completed) {
                        taskText.addClass('task-completed');
                    } else {
                        taskText.removeClass('task-completed');
                    }
                    
                    updateStats();
                    updateProgress();
                    updateLastSaved();
                }
            });

            // Delete task
            $(document).on('click', '.delete-btn', function() {
                const taskId = parseInt($(this).data('id'));
                const taskItem = $(this).closest('.task-item');
                
                if (confirm('Are you sure you want to delete this task?')) {
                    taskItem.addClass('fade-out');
                    
                    setTimeout(() => {
                        tasks = tasks.filter(t => t.id !== taskId);
                        saveTasks();
                        renderTasks();
                        updateStats();
                        updateProgress();
                        updateLastSaved();
                    }, 300);
                }
            });

            // Edit task
            $(document).on('click', '.edit-btn', function() {
                const taskId = parseInt($(this).data('id'));
                const task = tasks.find(t => t.id === taskId);
                const taskText = $(this).closest('.task-item').find('.task-text');
                
                if (task) {
                    const currentText = task.text;
                    const input = $('<input type="text" class="edit-input flex-1">').val(currentText);
                    
                    taskText.replaceWith(input);
                    input.focus().select();
                    
                    input.on('blur', function() {
                        const newText = $(this).val().trim();
                        if (newText && newText !== currentText) {
                            task.text = newText;
                            saveTasks();
                            updateLastSaved();
                        }
                        renderTasks();
                    });
                    
                    input.on('keypress', function(e) {
                        if (e.which === 13) {
                            $(this).blur();
                        }
                    });
                }
            });

            // Clear completed tasks
            $('#clearCompleted').on('click', function() {
                if (confirm('Are you sure you want to clear all completed tasks?')) {
                    tasks = tasks.filter(t => !t.completed);
                    saveTasks();
                    renderTasks();
                    updateStats();
                    updateProgress();
                    updateLastSaved();
                }
            });

            // Filter buttons
            $('.filter-btn').on('click', function() {
                currentFilter = $(this).data('filter');
                $('.filter-btn').removeClass('bg-blue-600 text-white').addClass('bg-gray-200 text-gray-700');
                $(this).removeClass('bg-gray-200 text-gray-700').addClass('bg-blue-600 text-white');
                renderTasks();
            });

            // Category filter
            $('#categoryFilter').on('change', function() {
                currentCategoryFilter = $(this).val();
                renderTasks();
            });

            // Search
            $('#searchInput').on('input', function() {
                renderTasks();
            });

            // Sort tasks
            $('#sortTasks').on('click', function() {
                const sortOptions = ['created', 'priority', 'time'];
                const currentIndex = sortOptions.indexOf(sortBy);
                sortBy = sortOptions[(currentIndex + 1) % sortOptions.length];
                
                const sortLabels = {
                    'created': 'Created',
                    'priority': 'Priority',
                    'time': 'Time'
                };
                
                $(this).html(`<i class="fas fa-sort mr-1"></i>Sort by ${sortLabels[sortBy]}`);
                renderTasks();
            });

            // Keyboard shortcuts
            $(document).on('keydown', function(e) {
                // Alt + N: New task
                if (e.altKey && e.keyCode === 78) {
                    e.preventDefault();
                    $('#taskInput').focus();
                }
                
                // Alt + F: Search
                if (e.altKey && e.keyCode === 70) {
                    e.preventDefault();
                    $('#searchInput').focus();
                }
                
                // Alt + D: Dark mode
                if (e.altKey && e.keyCode === 68) {
                    e.preventDefault();
                    $('#darkModeToggle').click();
                }
            });

            // Update last saved time
            function updateLastSaved() {
                const now = new Date();
                const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                $('#lastSaved').text(`Last saved: ${timeString}`);
            }

            // Render tasks function
            function renderTasks() {
                const taskList = $('#taskList');
                const emptyState = $('#emptyState');
                const searchTerm = $('#searchInput').val().toLowerCase();
                
                taskList.empty();
                
                // Filter tasks
                let filteredTasks = tasks.filter(task => {
                    // Status filter
                    if (currentFilter === 'active' && task.completed) return false;
                    if (currentFilter === 'completed' && !task.completed) return false;
                    if (currentFilter === 'high' && task.priority !== 'high') return false;
                    
                    // Category filter
                    if (currentCategoryFilter && task.category !== currentCategoryFilter) return false;
                    
                    // Search filter
                    if (searchTerm && !task.text.toLowerCase().includes(searchTerm)) return false;
                    
                    return true;
                });
                
                // Sort tasks
                filteredTasks.sort((a, b) => {
                    if (sortBy === 'priority') {
                        const priorityOrder = { high: 0, medium: 1, low: 2 };
                        return priorityOrder[a.priority] - priorityOrder[b.priority];
                    } else if (sortBy === 'time') {
                        if (a.time && b.time) {
                            return a.time.localeCompare(b.time);
                        }
                        return a.time ? -1 : (b.time ? 1 : 0);
                    } else {
                        return new Date(b.createdAt) - new Date(a.createdAt);
                    }
                });
                
                if (filteredTasks.length === 0) {
                    emptyState.show();
                    $('#clearCompleted').hide();
                } else {
                    emptyState.hide();
                    
                    filteredTasks.forEach(task => {
                        const categoryClass = `category-${task.category}`;
                        const priorityClass = `priority-${task.priority}`;
                        const timeDisplay = task.time ? `<span class="text-xs text-gray-500 ml-2"><i class="far fa-clock"></i> ${task.time}</span>` : '';
                        const priorityIcon = task.priority === 'high' ? '<i class="fas fa-exclamation-circle text-red-500"></i>' : 
                                           task.priority === 'medium' ? '<i class="fas fa-exclamation-circle text-yellow-500"></i>' : 
                                           '<i class="fas fa-info-circle text-green-500"></i>';
                        
                        const taskElement = $(`
                            <div class="task-item ${priorityClass} flex items-start gap-3 p-3 hover:bg-gray-50 rounded-lg transition-colors duration-200">
                                <input 
                                    type="checkbox" 
                                    class="task-checkbox w-5 h-5 text-blue-600 rounded focus:ring-blue-500 cursor-pointer mt-0.5" 
                                    data-id="${task.id}"
                                    ${task.completed ? 'checked' : ''}
                                >
                                <div class="flex-1">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="task-text flex-1 text-gray-800 ${task.completed ? 'task-completed' : ''}">${escapeHtml(task.text)}</span>
                                        <span class="text-xs px-2 py-1 rounded-full ${categoryClass}">${task.category}</span>
                                        ${timeDisplay}
                                    </div>
                                    <div class="flex items-center gap-2 text-xs text-gray-500">
                                        ${priorityIcon}
                                        <span class="capitalize">${task.priority} priority</span>
                                        <span>•</span>
                                        <span>Created: ${new Date(task.createdAt).toLocaleDateString()}</span>
                                    </div>
                                </div>
                                <div class="flex gap-1">
                                    <button 
                                        class="edit-btn text-gray-500 hover:text-blue-600 transition-colors duration-200 p-1" 
                                        data-id="${task.id}"
                                        title="Edit task"
                                    >
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button 
                                        class="delete-btn text-red-500 hover:text-red-700 transition-colors duration-200 p-1" 
                                        data-id="${task.id}"
                                        title="Delete task"
                                    >
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>
                        `);
                        taskList.append(taskElement);
                    });
                    
                    // Show clear completed button if there are completed tasks
                    if (tasks.some(t => t.completed)) {
                        $('#clearCompleted').show();
                    } else {
                        $('#clearCompleted').hide();
                    }
                }
            }

            // Update statistics
            function updateStats() {
                const total = tasks.length;
                const completed = tasks.filter(t => t.completed).length;
                const pending = total - completed;
                const highPriority = tasks.filter(t => t.priority === 'high' && !t.completed).length;
                
                $('#totalTasks').text(total);
                $('#completedTasks').text(completed);
                $('#pendingTasks').text(pending);
                $('#highPriorityTasks').text(highPriority);
            }

            // Update progress bar
            function updateProgress() {
                const total = tasks.length;
                const completed = tasks.filter(t => t.completed).length;
                const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
                
                $('#progressBar').css('width', percentage + '%');
                $('#progressText').text(percentage + '%');
            }

            // Save tasks to localStorage
            function saveTasks() {
                localStorage.setItem('dailyTasks', JSON.stringify(tasks));
            }

            // Escape HTML to prevent XSS
            function escapeHtml(text) {
                const map = {
                    '&': '&amp;',
                    '<': '&lt;',
                    '>': '&gt;',
                    '"': '&quot;',
                    "'": '&#039;'
                };
                return text.replace(/[&<>"']/g, m => map[m]);
            }
        });
    </script>
</body>
</html>